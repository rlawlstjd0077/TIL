# 4장. 스트림 소개

## 스트림 시작하기

- 자바 8컬렉션에는 스트림을 반환하는 `stream` 메서드가 추가되었다. (java.util.stream.Stream 참고)
- 스트림이란 '데이터 처리 연산을 지원하도록 소스에서 추출된 연속된 요소'로 정의할 수 있다.
    - 연속된 요소
        - 스트림은 특정 요소 형식으로 이루어진 연속된 값 집합의 인터페이스를 제공함
        - 컬렉션의 주제는 데이터이고 스트림의 주제는 계산임
    - 소스
        - 컬렉션, 배열, I/O 자원 등의 데이터 제공 소스로부터 데이터를 소비함
    - 데이터 처리 연산
        - 함수형 프로그래밍언어에서 일반적으로 지원하는 연산과 `sort`등으로 데이터를 조작할 수 있음
    - 파이프라이닝
        - 대부분의 스트림 연산은 스트림 연산끼리 연결해서 커다란 파이프라인을 구성할 수 있도록 **스트림 자신을 반환함**
        - 덕분에 게으름(Laziness), 쇼트서킷(short-circuiting) 같은 최적화도 얻을 수 있음
        - 데이터 소스에 적용하는 데이터베이스 질의와 비슷함
    - 내부 반복
        - 반복자를 이용해서 명시적으로 반복하는 컬렉션과 달리 스트림은 내부 반복을 지원함

## 스트림과 컬렉션

### 차이점

- 데이터를 언제 계산하느냐가 이 둘의 가장 큰 차이점임
    - 컬렉션은 현재 자료구조가 포함하는 모든 값을 메모리에 저장하는 자료구조이다 .
        - 컬렉션의 모든 요소는 컬렉션에 추가하기 전에 모두 계산되어야 함
    - 스트림은 요청할 때만 요소를 계산하는 고정된 자료구조임
        - 스트림에 요소를 추가하거나 요소를 제거할 수 없다.
        - 스트림은 생산자와 소비자 관계를 형성하며 사용자가 요청할 때만 값을 계산하기에 게으르게 만들어지는 컬렉션과 같음
- 외부 반복과 내부 반복
    - 컬렉션 인터페이스를 사용하려면 사용자가 직접 요소를 반복해야 하는데 이를 **외부 반복**이라고 함
    - 스트림 라이브러리는 반복을 알아서 처리하고 결과 스트림값을 어딘가에 저장해주는 **내부 반복**을 사용함

### 공통점

- 딱 한번만 탐색할 수 있다.
- 한 번 탐색한 요소를 다시 탐색하려면 초기 데이터 소스에서 새로운 스트림을 만들어야 함

```java
List<String> list = Arrays.asList("1", "2", "3");
Stream<String> s = list.stream();
s.forEach(System.out::println);

//스트림이 소비되거나 닫혀 java.lang.IllegalStateException이 발생
s.forEach(System.out::println);
```